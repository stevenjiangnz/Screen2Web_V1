<div class="row">

    <div class="col-sm-8 middle-panel">
        <div class="row">
            <div class="row">
                <div class="col-lg-5"><h1>Manage Transaction</h1></div>

                <div class="col-lg-7 pull-right">
                </div>
            </div>
            <div>
                <div ng-show="!vm.isloading">
                    <div class="pull-left">
                        <select class="pull-right page-size-selector" name="itemSize" ng-model="itemSize">
                            <option value="100">100</option>
                            <option value="200">200</option>
                            <option value="-1">All</option>
                        </select>
                    </div>
                    <div>
                        <div class="pull-right" style="padding-right: 20px" ng-show="positionList.length > 0"><h4>
                            Total: {{positionList.length}}</h4>
                        </div>
                        <div class="row table-container">
                            <table class="table table-bordered table-striped ">
                                <thead>
                                <tr>
                                    <th>
                                       <span class="sortable-header"
                                             ng-click="sortType = 'id'; sortReverse = !sortReverse">
                                        ID
                                        <span ng-show="sortType == 'id' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'id' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                        <span class="sortable-header"
                                              ng-click="sortType = 'shareId'; sortReverse = !sortReverse">
                                        Share
                                        <span ng-show="sortType == 'shareId' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'shareId' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                       <span class="sortable-header"
                                             ng-click="sortType = 'size'; sortReverse = !sortReverse">
                                        Size
                                        <span ng-show="sortType == 'size' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'size' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                       <span class="sortable-header"
                                             ng-click="sortType = 'entryPrice'; sortReverse = !sortReverse">
                                        Entry Price
                                        <span ng-show="sortType == 'entryPrice' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'entryPrice' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                        <span class="sortable-header"
                                              ng-click="sortType = 'entryFee'; sortReverse = !sortReverse">
                                        Entry Fee
                                        <span ng-show="sortType == 'entryFee' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'entryFee' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                        <span class="sortable-header"
                                              ng-click="sortType = 'entryDate'; sortReverse = !sortReverse">
                                        Entry Date
                                        <span ng-show="sortType == 'entryDate' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'entryDate' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                        <span class="sortable-header"
                                              ng-click="sortType = 'exitPrice'; sortReverse = !sortReverse">
                                        Exit Price
                                        <span ng-show="sortType == 'exitPrice' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'exitPrice' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                        <span class="sortable-header"
                                              ng-click="sortType = 'exitFee'; sortReverse = !sortReverse">
                                        Exit Fee
                                        <span ng-show="sortType == 'exitFee' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'exitFee' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                       <span class="sortable-header"
                                             ng-click="sortType = 'exitDate'; sortReverse = !sortReverse">
                                        Exit Date
                                        <span ng-show="sortType == 'exitDate' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'exitDate' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                       <span class="sortable-header"
                                             ng-click="sortType = 'diff'; sortReverse = !sortReverse">
                                        Diff
                                        <span ng-show="sortType == 'diff' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'diff' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th>
                                       <span class="sortable-header"
                                             ng-click="sortType = 'diff_Per'; sortReverse = !sortReverse">
                                        %
                                        <span ng-show="sortType == 'diff_Per' && !sortReverse"
                                              class="fa fa-caret-down pull-right"></span>
                                        <span ng-show="sortType == 'diff_Per' && sortReverse"
                                              class="fa fa-caret-up pull-right"></span>
                                        </span>
                                    </th>
                                    <th></th>

                                </tr>
                                </thead>
                                <tbody>
                                <tr dir-paginate="b in positionList | orderBy:sortType:sortReverse | itemsPerPage:15">
                                    <td>{{b.id}}</td>
                                    <td><a ui-sref="stock({shareId:b.shareId})" target="sharechart">{{getShare(b.shareId).symbol}} ({{b.shareId}})</a></td>
                                    <td>{{b.size}}</td>
                                    <td>{{b.entryPrice | currency}}</td>
                                    <td>{{b.entryFee | currency}}</td>
                                    <td>{{b.entryDate}}</td>
                                    <td><span ng-show="b.exitDate">{{b.exitPrice | currency}}</span></td>
                                    <td><span ng-show="b.exitDate">{{b.exitFee | currency}}</span></td>
                                    <td>{{b.exitDate}}</td>
                                    <td ng-class="{'positive': b.diff > 0, 'negative': b.diff < 0}">{{b.diff |
                                        currency}}
                                    </td>
                                    <td ng-class="{'positive': b.diff_Per > 0, 'negative': b.diff_Per < 0}">{{b.diff_Per
                                        | number : 2}} <span ng-show="b.diff_Per">%</span>
                                    </td>
                                    <td>
                                        <i class="fa fa-arrow-right"
                                           ng-click="displayPositionDetails(b)"></i>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="pull-right">
                            <dir-pagination-controls></dir-pagination-controls>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row loading-section clearfix" ng-show="vm.isloading">
                <h4><i class="fa fa-tasks"></i>
                    Loading data...</h4>
            </div>
            <div class="" ng-show="currentPosition">
                <div class="row detail-sub-title" ng-init="reviewFormExpanded=true">
                    <i class="fa fa-minus-square pull-left" ng-show="reviewFormExpanded"
                       ng-click="reviewFormExpanded=!reviewFormExpanded"></i>
                    <i class="fa fa-plus-square pull-left" ng-show="!reviewFormExpanded"
                       ng-click="reviewFormExpanded=!reviewFormExpanded"></i>

                </div>
                <div ng-show="reviewFormExpanded==true">
                    <trade-review current-position="currentPosition"></trade-review>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-4 right-panel">

        <div class="panel-container" ng-show="currentPosition">
            <ul class="nav nav-pills" ng-init="activeActionPanel='details'">
                <li ng-class="{active: activeActionPanel=='details'}"><a
                        ng-click="activeActionPanel='details'">Details</a>
                </li>
            </ul>
            <div class="panel panel-default">
                <!-- Details panel -->
                <div class="panel-body" ng-if="activeActionPanel=='details'">
                    <div class="detail-container">
                        <h4>Id: {{currentPosition.id}}</h4>
                        <div class="row detail-sub-title" ng-init="shareDetailExpanded=true">
                            <label>{{getShare(currentPosition.shareId).symbol}} ({{currentPosition.shareId}})</label>
                        </div>
                        <div class="detail-sub-section" ng-show="shareDetailExpanded">
                            <table class="table table-striped table-hover table-detail-view " style="font-size: 1em">
                                <tbody>
                                <tr>
                                    <td class="table-detail-key" style="width: 50px">Entry</td>
                                    <td class="table-detail-value">
                                        <div class="col-sm-12">{{entryTransaction.message}}</div>
                                        <div class="col-sm-12">Trading Date: {{entryTransaction.tradingDate}}</div>
                                        <div class="col-sm-6">Size: {{entryTransaction.size}}</div>
                                        <div class="col-sm-6">price: {{entryTransaction.price | currency}}</div>
                                        <div class="col-sm-6">Fee: {{entryTransaction.fee | currency}}</div>
                                    </td>
                                </tr>
                                <tr ng-show="exitTransaction">
                                    <td>Exit</td>
                                    <td class="table-detail-value">
                                        <div class="col-sm-12">{{exitTransaction.message}}</div>
                                        <div class="col-sm-12">Trading Date: {{exitTransaction.tradingDate}}</div>
                                        <div class="col-sm-6">Size: {{exitTransaction.size}}</div>
                                        <div class="col-sm-6">price: {{exitTransaction.price | currency}}</div>
                                        <div class="col-sm-6">Fee: {{exitTransaction.fee | currency}}</div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Result</td>
                                    <td class="table-detail-value">
                                        <div class="col-sm-6">Diff: <span
                                                ng-class="{'positive': currentPosition.diff > 0, 'negative': currentPosition.diff < 0}">{{currentPosition.diff | currency}}</span>
                                        </div>
                                        <div class="col-sm-6">Diff Per: <span
                                                ng-class="{'positive': currentPosition.diff > 0, 'negative': currentPosition.diff < 0}">{{currentPosition.diff_Per | number: 2}}%</span>
                                        </div>
                                        <div class="col-sm-6">Days Span: {{currentPosition.days}}</div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
